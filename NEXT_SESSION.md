# ğŸ“‹ Next Session Plan

æ¬¡å›ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å®Ÿæ–½ã™ã‚‹å†…å®¹ã‚’ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚

---

## âœ… å‰å›ï¼ˆä»Šå›ï¼‰å®Œäº†ã—ãŸå†…å®¹

### 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
- âœ… ä¼æ¥­å‘ã‘ç ”ä¿®ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸ä½œæˆ
- âœ… ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³å¯¾å¿œ
- âœ… 3ç¨®é¡ã®å•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ å®Ÿè£…
  - 30åˆ†ç„¡æ–™ç›¸è«‡ç”³ã—è¾¼ã¿
  - ã‚µãƒ¼ãƒ“ã‚¹è³‡æ–™ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
  - ãŠå•ã„åˆã‚ã›

### 2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…
- âœ… Node.js + Express
- âœ… ãƒ¡ãƒ¼ãƒ«è‡ªå‹•é€ä¿¡æ©Ÿèƒ½ï¼ˆNodemailerï¼‰
- âœ… ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦UI
- âœ… APIå®Ÿè£…ï¼ˆ/api/consultation, /api/download, /api/contactï¼‰

### 3. ãƒ‡ãƒ—ãƒ­ã‚¤
- âœ… GitHubãƒªãƒã‚¸ãƒˆãƒªä½œæˆãƒ»ãƒ—ãƒƒã‚·ãƒ¥
  - ãƒªãƒã‚¸ãƒˆãƒª: https://github.com/MICHANWANWAN/training-service-lp
- âœ… Vercelã«è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
  - URL: https://training-service-lp.vercel.app/
- âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ä¸­ï¼ˆhttp://localhost:3000ï¼‰

### 4. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™
- âœ… README.mdæ›´æ–°
- âœ… ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †æ›¸ä½œæˆ
- âœ… ãƒ¡ãƒ¼ãƒ«è¨­å®šæ‰‹é †æ›¸ä½œæˆ

---

## ğŸ¯ æ¬¡å›ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã‚„ã‚‹ã“ã¨

### **ã‚ªãƒ—ã‚·ãƒ§ãƒ³1: GCP VMã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆæ¨å¥¨ï¼‰**

#### ç¾åœ¨ã®GCPç’°å¢ƒ
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: twitter-automation-475909
- **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**: aiyashafukuro@gmail.com
- **VMã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹**: ai-creator-automation-v2
  - ã‚¾ãƒ¼ãƒ³: us-central1-c
  - ã‚¿ã‚¤ãƒ—: e2-microï¼ˆGCPç„¡æ–™æ å¯¾è±¡ï¼‰
  - å¤–éƒ¨IP: 34.173.39.69
  - çŠ¶æ…‹: RUNNING âœ…

#### ãƒ¡ãƒªãƒƒãƒˆ
- âœ… **è¿½åŠ ã‚³ã‚¹ãƒˆãªã—** - æ—¢å­˜ã®VMã‚’æ´»ç”¨
- âœ… **å®Œå…¨ãªåˆ¶å¾¡** - rootæ¨©é™ã‚ã‚Š
- âœ… **å•†ç”¨åˆ©ç”¨OK** - åˆ¶é™ãªã—
- âœ… **ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®šå¯èƒ½**

---

### ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ï¼ˆ3ã¤ã‹ã‚‰é¸æŠï¼‰

#### **æ–¹æ³•A: Docker Composeï¼ˆæœ€ã‚‚ç°¡å˜ï¼‰**

```bash
# 1. VMã«æ¥ç¶š
gcloud compute ssh ai-creator-automation-v2 --zone=us-central1-c

# 2. ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/MICHANWANWAN/training-service-lp.git
cd training-service-lp

# 3. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
cp .env.example .env
nano .env  # ãƒ¡ãƒ¼ãƒ«è¨­å®šã‚’ç·¨é›†

# 4. Dockerã§èµ·å‹•
docker-compose up -d

# 5. ç¢ºèª
docker-compose ps
docker-compose logs
```

**ã‚¢ã‚¯ã‚»ã‚¹URL**: http://34.173.39.69:3000

---

#### **æ–¹æ³•B: PM2ã§ç›´æ¥èµ·å‹•ï¼ˆè»½é‡ï¼‰**

```bash
# 1. VMã«æ¥ç¶š
gcloud compute ssh ai-creator-automation-v2 --zone=us-central1-c

# 2. ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/MICHANWANWAN/training-service-lp.git
cd training-service-lp

# 3. Node.jsã¨npmã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆæœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®å ´åˆï¼‰
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# 4. ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# 5. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
cp .env.example .env
nano .env

# 6. PM2ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo npm install -g pm2

# 7. PM2ã§èµ·å‹•
pm2 start server.js --name training-service-lp

# 8. è‡ªå‹•èµ·å‹•è¨­å®š
pm2 startup
pm2 save

# 9. ç¢ºèª
pm2 status
pm2 logs training-service-lp
```

**ã‚¢ã‚¯ã‚»ã‚¹URL**: http://34.173.39.69:3000

---

#### **æ–¹æ³•C: Nginx + PM2ï¼ˆæœ¬æ ¼é‹ç”¨ãƒ»ãƒãƒ¼ãƒˆ80/443ï¼‰**

```bash
# 1. VMã«æ¥ç¶šã—ã¦PM2ã§èµ·å‹•ï¼ˆæ–¹æ³•Bã¨åŒã˜ï¼‰
# 2. Nginxã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo apt-get update
sudo apt-get install -y nginx

# 3. Nginxè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
sudo nano /etc/nginx/sites-available/training-service-lp

# ä»¥ä¸‹ã®å†…å®¹ã‚’è²¼ã‚Šä»˜ã‘ï¼š
server {
    listen 80;
    server_name 34.173.39.69;  # ã¾ãŸã¯ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}

# 4. è¨­å®šã‚’æœ‰åŠ¹åŒ–
sudo ln -s /etc/nginx/sites-available/training-service-lp /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx

# 5. HTTPSã‚’è¨­å®šï¼ˆLet's Encryptï¼‰
sudo apt-get install -y certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

**ã‚¢ã‚¯ã‚»ã‚¹URL**:
- HTTP: http://34.173.39.69
- HTTPS: https://your-domain.comï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®šå¾Œï¼‰

---

### ğŸ”¥ ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šï¼ˆå¿…é ˆï¼‰

VMã®ãƒãƒ¼ãƒˆã‚’é–‹æ”¾ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

```bash
# ãƒãƒ¼ãƒˆ3000ã‚’é–‹æ”¾ï¼ˆæ–¹æ³•Aã¾ãŸã¯Bï¼‰
gcloud compute firewall-rules create allow-training-service-3000 \
  --allow tcp:3000 \
  --source-ranges 0.0.0.0/0 \
  --description "Allow access to training service LP on port 3000"

# ãƒãƒ¼ãƒˆ80/443ã‚’é–‹æ”¾ï¼ˆæ–¹æ³•Cï¼‰
gcloud compute firewall-rules create allow-http-https \
  --allow tcp:80,tcp:443 \
  --source-ranges 0.0.0.0/0 \
  --description "Allow HTTP and HTTPS traffic"

# ç¢ºèª
gcloud compute firewall-rules list
```

---

### ğŸ“§ ãƒ¡ãƒ¼ãƒ«æ©Ÿèƒ½ã®è¨­å®šï¼ˆé‡è¦ï¼‰

#### Gmailã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å–å¾—

1. **2æ®µéšèªè¨¼ã‚’æœ‰åŠ¹åŒ–**
   - https://myaccount.google.com/security
   - ã€Œ2æ®µéšèªè¨¼ãƒ—ãƒ­ã‚»ã‚¹ã€ã‚’ã‚ªãƒ³

2. **ã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ**
   - https://myaccount.google.com/apppasswords
   - ã€Œã‚¢ãƒ—ãƒªã‚’é¸æŠã€â†’ã€Œãã®ä»–ï¼ˆã‚«ã‚¹ã‚¿ãƒ åï¼‰ã€
   - ã€Œtraining-service-lpã€ã¨å…¥åŠ›
   - ã€Œç”Ÿæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
   - 16æ¡ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼

3. **.envãƒ•ã‚¡ã‚¤ãƒ«ã«è¨­å®š**

```env
EMAIL_SERVICE=gmail
EMAIL_USER=aiyashafukuro@gmail.com
EMAIL_PASS=xxxx xxxx xxxx xxxx  # 16æ¡ã®ã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
ADMIN_EMAIL=aiyashafukuro@gmail.com
```

4. **Vercelã®ç’°å¢ƒå¤‰æ•°ã«ã‚‚è¨­å®š**ï¼ˆVercelã‚’ä½¿ã„ç¶šã‘ã‚‹å ´åˆï¼‰
   - https://vercel.com/dashboard
   - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ `training-service-lp` â†’ Settings â†’ Environment Variables
   - ä¸Šè¨˜3ã¤ã‚’è¿½åŠ ã—ã¦å†ãƒ‡ãƒ—ãƒ­ã‚¤

---

### ğŸ” å‹•ä½œç¢ºèªæ‰‹é †

1. **ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹**
   - ãƒ–ãƒ©ã‚¦ã‚¶ã§è©²å½“URLã‚’é–‹ã
   - ãƒ‡ã‚¶ã‚¤ãƒ³ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèª

2. **ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ã‚¹ãƒˆ**
   - ã€Œ30åˆ†ç„¡æ–™ç›¸è«‡ã«ç”³ã—è¾¼ã‚€ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
   - ãƒ•ã‚©ãƒ¼ãƒ ã«å…¥åŠ›ã—ã¦é€ä¿¡
   - ç®¡ç†è€…ãƒ¡ãƒ¼ãƒ«ã¨è‡ªå‹•è¿”ä¿¡ãƒ¡ãƒ¼ãƒ«ãŒå±Šãã‹ç¢ºèª

3. **ãƒ­ã‚°ç¢ºèª**
   ```bash
   # Docker Composeã®å ´åˆ
   docker-compose logs -f

   # PM2ã®å ´åˆ
   pm2 logs training-service-lp

   # Nginxã®å ´åˆ
   sudo tail -f /var/log/nginx/access.log
   sudo tail -f /var/log/nginx/error.log
   ```

---

### ğŸŒ ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼š

1. **DNSãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¨­å®š**
   - Aãƒ¬ã‚³ãƒ¼ãƒ‰: `@` â†’ `34.173.39.69`
   - Aãƒ¬ã‚³ãƒ¼ãƒ‰: `www` â†’ `34.173.39.69`

2. **Nginxè¨­å®šã‚’æ›´æ–°**
   ```bash
   sudo nano /etc/nginx/sites-available/training-service-lp
   # server_name ã‚’ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã«å¤‰æ›´
   ```

3. **SSLè¨¼æ˜æ›¸ã‚’å–å¾—**
   ```bash
   sudo certbot --nginx -d your-domain.com -d www.your-domain.com
   ```

---

## ğŸ“Š ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ã®æ¯”è¼ƒ

| æ–¹æ³• | ç°¡å˜ã• | èµ·å‹•é€Ÿåº¦ | ãƒãƒ¼ãƒˆ | SSL | ãŠã™ã™ã‚ç”¨é€” |
|------|--------|---------|--------|-----|------------|
| **Docker Compose** | â­â­â­ | æ™®é€š | 3000 | âŒ | ãƒ†ã‚¹ãƒˆãƒ»é–‹ç™º |
| **PM2** | â­â­ | é€Ÿã„ | 3000 | âŒ | è»½é‡é‹ç”¨ |
| **Nginx + PM2** | â­ | é€Ÿã„ | 80/443 | âœ… | æœ¬ç•ªé‹ç”¨ |

---

## ğŸ’¡ æ¨å¥¨ãƒ•ãƒ­ãƒ¼

### Step 1: ã¾ãšã¯ç°¡å˜ã«ãƒ†ã‚¹ãƒˆï¼ˆDocker Composeï¼‰
```bash
gcloud compute ssh ai-creator-automation-v2 --zone=us-central1-c
git clone https://github.com/MICHANWANWAN/training-service-lp.git
cd training-service-lp
cp .env.example .env
nano .env  # ãƒ¡ãƒ¼ãƒ«è¨­å®š
docker-compose up -d
```

### Step 2: å‹•ä½œç¢ºèª
- http://34.173.39.69:3000 ã«ã‚¢ã‚¯ã‚»ã‚¹
- ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ãƒ†ã‚¹ãƒˆ

### Step 3: æœ¬ç•ªé‹ç”¨ãªã‚‰Nginxè¿½åŠ 
- ãƒãƒ¼ãƒˆ80/443ã§å…¬é–‹
- Let's Encryptã§SSLè¨¼æ˜æ›¸å–å¾—

---

## ğŸ”— ä¾¿åˆ©ãªã‚³ãƒãƒ³ãƒ‰é›†

```bash
# VMã«æ¥ç¶š
gcloud compute ssh ai-creator-automation-v2 --zone=us-central1-c

# Dockerã®çŠ¶æ…‹ç¢ºèª
docker-compose ps
docker-compose logs -f

# PM2ã®çŠ¶æ…‹ç¢ºèª
pm2 status
pm2 logs training-service-lp

# ã‚µãƒ¼ãƒãƒ¼å†èµ·å‹•
pm2 restart training-service-lp

# Gitã§æœ€æ–°ç‰ˆã‚’å–å¾—
cd training-service-lp
git pull origin main
pm2 restart training-service-lp

# ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ç¢ºèª
gcloud compute firewall-rules list
```

---

## âš ï¸ æ³¨æ„äº‹é …

1. **ãƒ¡ãƒ¼ãƒ«è¨­å®šã¯å¿…é ˆ**
   - Gmailã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã¦.envã«è¨­å®š

2. **ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šã‚’å¿˜ã‚Œãšã«**
   - ãƒãƒ¼ãƒˆé–‹æ”¾ã—ãªã„ã¨ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“

3. **Vercelã¯ä¸¦è¡Œé‹ç”¨å¯èƒ½**
   - ãƒ†ã‚¹ãƒˆç’°å¢ƒã¨ã—ã¦Vercelã‚’æ®‹ã—ã¦ãŠãã®ã‚‚OK
   - GCP VMã‚’æœ¬ç•ªç’°å¢ƒã¨ã—ã¦ä½¿ç”¨

4. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**
   - æœ¬ç•ªé‹ç”¨æ™‚ã¯HTTPSå¿…é ˆ
   - .envãƒ•ã‚¡ã‚¤ãƒ«ã¯çµ¶å¯¾ã«Gitã«ãƒ—ãƒƒã‚·ãƒ¥ã—ãªã„

---

## ğŸ“ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

æ¬¡å›ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ç¢ºèªã™ã‚‹é …ç›®ï¼š

- [ ] ã©ã®ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ã‚’é¸ã¶ã‹æ±ºå®š
- [ ] GCP VMã«SSHæ¥ç¶š
- [ ] ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
- [ ] .envãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ¡ãƒ¼ãƒ«è¨­å®š
- [ ] ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®š
- [ ] ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹ç¢ºèª
- [ ] ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ãƒ†ã‚¹ãƒˆ
- [ ] ãƒ¡ãƒ¼ãƒ«å—ä¿¡ç¢ºèª
- [ ] ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰Nginx + SSLè¨­å®š
- [ ] ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®š

---

## ğŸ”— ãƒªãƒ³ã‚¯é›†

- **æœ¬ç•ªã‚µã‚¤ãƒˆï¼ˆVercelï¼‰**: https://training-service-lp.vercel.app/
- **GitHubãƒªãƒã‚¸ãƒˆãƒª**: https://github.com/MICHANWANWAN/training-service-lp
- **GCP Console**: https://console.cloud.google.com/
- **Vercelãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: https://vercel.com/dashboard

---

**ä½œæˆæ—¥**: 2025-11-10
**æ¬¡å›ã‚»ãƒƒã‚·ãƒ§ãƒ³**: ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã—ã¦GCP VMã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿæ–½
